---
title: 源码设计模式
date: 2021/04/17 12:34:30
tags: [源码, 设计模式]
categories: 设计模式
top: 3
toc: true
---
### 从源码中学到的设计模式
在写一些组件或者工具库的时候，会遇到怎么去向外提供我们所构建对象的问题，这里对常用的设计模式做一个简单的介绍。  

#### 工厂模式
在jquery时代，我们经常会频繁的操作dom，在我们获取一个dom的时候，大家有没想有想过，是不是要每次都通过new去创建一个新的jquery对象呢？肯定不是的。  
jquery就是利用了工厂模式去向外提供对象，工厂模式适用于频繁的需要创建对象的场景

#### 建造者模式
以vue为例，我们使用vue的时候，是通过new一个vue对象的方式来使用的，这是一个非常复杂的类，其中分了很多的模块，比如render等模块，可以对立开发，然后混合进vue中，我们来看一下vue源码：  
![](https://liangdo-top.oss-cn-shenzhen.aliyuncs.com/blog/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202021-09-04%20%E4%B8%8A%E5%8D%8810.58.14.png)
这里是Vue的入口，首先是判断了是不是通过new来构建的vue对象，然后初始化配置，下面是vue的几个模块：初始化模块、状态模块、事件模块、生命周期模块、渲染模块，这几个模块都是对立开发的，然后分别暴露出mix接口，接收一个Vue构造函数，将具体的功能混合进构造函数中，从而完善其功能。  
不止是，包括jquery功能的实现也是用到了这种设计模式，所以设计模式不是单一的，在不同项目中可以根据场景灵活使用

#### 函数式编程模式
在vue3和react中，都是使用了函数式编程，其目的是为了tree shaking,对于复杂的三方库，我们绝大多数时候是使用不到全部的语法的，如果我们将功能的实现都挂载在原型链上，是无法去按需加载对应功能的，如果用函数式编程，可以按需引入对应函数，这也是jquery缺点是臃肿的原因；函数式编程还有一点好处是对项目进行维护等工作会更灵活  

#### 享元模式
在我们平时编写代码的时候，会经常遇到if else分支中写非常类似的代码，这种情况是可以用到享元模式去进行一个优化的
享元模式核心是分析提取出代码中不同的地方，通过变量存储，去对不同点进行判断，然后去使用，达到优化代码的作用，也提升了代码后期的可维护性


#### 总结
广义上来讲，设计模式就是一种根据具体代码问题的情景，使用一种更为合理的编程方案。设计模式需要我们在不同项目中灵活的运用，这是一个经验积累的过程  
学习源码这些设计模式，可以从更底层的角度去审视项目的合理性，长远角度来看，这是比具体代码实现更为重要的工作，他能帮助我们设计出更为优秀的项目，写出更为健壮、可扩展性和功能更为强大的代码。  
